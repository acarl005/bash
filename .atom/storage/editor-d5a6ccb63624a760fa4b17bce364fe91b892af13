{"version":1,"windowDimensions":{"x":65,"y":24,"width":1855,"height":1056,"maximized":true},"grammars":{"grammarOverridesByPath":{}},"project":{"deserializer":"Project","paths":["/home/andy/Documents/codesmith/lectures/unit-11-authentication/auth-demo"],"buffers":[{"id":"b30cb911562665375217a3e271822240","text":"var express = require('express');\nvar app = express();\nvar bodyParser = require('body-parser');\nvar cookieParser = require('cookie-parser');\n\napp.use(bodyParser.urlencoded());\napp.use(cookieParser());\n\napp.get('/', function(req, res) {\n  res.sendFile(__dirname + '/login.html');\n});\n\napp.post('/login', function(req, res) {\n  var userId = users.findIndex(function(obj) {\n    return obj.username === req.body.username;\n  });\n  var user = users[userId];\n  if (user.password === req.body.password) {\n    res.cookie('userId', userId, {\n      maxAge: 360000,\n      // httpOnly: true,\n    });\n    res.redirect('/profile');\n  } else {\n    res.redirect('/');\n  }\n});\n\napp.get('/profile', auth, function(req, res) {\n  var userId = req.cookies.userId;\n  var user = users[userId];\n  res.write('hello ' + user.username);\n  res.end();\n});\n\n\nfunction auth(req, res, next) {\n  if (req.cookies.userId) next();\n  else res.redirect('/');\n}\n\nvar users = [\n  { username: 'andy', password: 'corn' },\n  { username: 'alex', password: 'corn' },\n  { username: 'ragu', password: 'corn' },\n];\n\n\napp.listen(3000, function() {\n  console.log('listening at http://localhost:3000');\n});\n","defaultMarkerLayerId":"0","markerLayers":{"0":{"id":"0","maintainHistory":false,"markersById":{"21":{"range":{"start":{"row":13,"column":0},"end":{"row":15,"column":0}},"properties":{},"reversed":false,"tailed":true,"valid":true,"invalidate":"never"},"22":{"range":{"start":{"row":34,"column":0},"end":{"row":34,"column":0}},"properties":{},"reversed":false,"tailed":true,"valid":true,"invalidate":"never"},"23":{"range":{"start":{"row":50,"column":0},"end":{"row":51,"column":0}},"properties":{},"reversed":false,"tailed":true,"valid":true,"invalidate":"never"}},"version":2},"1":{"id":"1","maintainHistory":false,"markersById":{},"version":2},"2":{"id":"2","maintainHistory":true,"markersById":{"1":{"range":{"start":{"row":34,"column":0},"end":{"row":34,"column":0}},"properties":{"type":"selection","goalScreenRange":null,"preserveFolds":true},"reversed":false,"tailed":true,"valid":true,"invalidate":"never"}},"version":2},"3":{"id":"3","maintainHistory":false,"markersById":{},"version":2},"4":{"id":"4","maintainHistory":false,"markersById":{},"version":2}},"nextMarkerLayerId":5,"history":{"version":3,"nextCheckpointId":6,"undoStack":[{"type":"group-start","snapshot":{"2":{"1":{"range":[[35,0],[37,2]],"properties":{"type":"selection","goalScreenRange":null},"reversed":true,"tailed":true,"valid":true,"invalidate":"never"}}}},{"type":"change","content":{"oldRange":[[35,0],[37,2]],"newRange":[[35,0],[35,0]],"oldText":"app.get('/edit-profile', auth, function(req, res) {\n  //....\n})","newText":""}},{"type":"group-end","snapshot":{"2":{"1":{"range":[[35,0],[35,0]],"properties":{"type":"selection","goalScreenRange":null},"reversed":false,"tailed":false,"valid":true,"invalidate":"never"}}}},{"type":"group-start","snapshot":{"2":{"1":{"range":[[35,0],[35,0]],"properties":{"type":"selection","goalScreenRange":null},"reversed":false,"tailed":false,"valid":true,"invalidate":"never"}}}},{"type":"change","content":{"oldRange":[[34,0],[35,0]],"newRange":[[34,0],[34,0]],"oldText":"\n","newText":""}},{"type":"group-end","snapshot":{"2":{"1":{"range":[[34,0],[34,0]],"properties":{"type":"selection","goalScreenRange":null},"reversed":false,"tailed":false,"valid":true,"invalidate":"never"}}}},{"type":"group-start","snapshot":{"2":{"1":{"range":[[34,0],[34,0]],"properties":{"type":"selection","goalScreenRange":null},"reversed":false,"tailed":false,"valid":true,"invalidate":"never"}}}},{"type":"change","content":{"oldRange":[[14,46],[14,47]],"newRange":[[14,46],[14,46]],"oldText":" ","newText":""}},{"type":"change","content":{"oldRange":[[13,46],[13,47]],"newRange":[[13,46],[13,46]],"oldText":" ","newText":""}},{"type":"change","content":{"oldRange":[[50,3],[50,3]],"newRange":[[50,3],[51,0]],"oldText":"","newText":"\n"}},{"type":"group-end","snapshot":{"2":{"1":{"range":[[34,0],[34,0]],"properties":{"type":"selection","goalScreenRange":null},"reversed":false,"tailed":true,"valid":true,"invalidate":"never"}}}}],"redoStack":[]},"encoding":"utf8","filePath":"/home/andy/Documents/codesmith/lectures/unit-11-authentication/auth-demo/server.js","digestWhenLastPersisted":"30357cfc31df6d5645b00f06c9a804996750e7b6","preferredLineEnding":null,"nextMarkerId":24,"deserializer":"TextBuffer","version":5}]},"workspace":{"deserializer":"Workspace","paneContainer":{"deserializer":"PaneContainer","version":1,"root":{"deserializer":"Pane","id":3,"items":[{"deserializer":"TextEditor","id":4,"softTabs":true,"firstVisibleScreenRow":25,"firstVisibleScreenColumn":0,"displayBuffer":{"deserializer":"DisplayBuffer","id":5,"softWrapped":false,"tokenizedBuffer":{"deserializer":"TokenizedBuffer","bufferPath":"/home/andy/Documents/codesmith/lectures/unit-11-authentication/auth-demo/server.js","bufferId":"b30cb911562665375217a3e271822240","largeFileMode":false},"largeFileMode":false,"foldsMarkerLayerId":"1"},"selectionsMarkerLayerId":"2"}],"activeItemURI":"/home/andy/Documents/codesmith/lectures/unit-11-authentication/auth-demo/server.js","focused":true,"flexScale":1},"activePaneId":3},"packagesWithActiveGrammars":["language-javascript","language-hyperlink","language-todo"],"destroyedItemURIs":[]},"packageStates":{"pigments":{"project":{"deserializer":"ColorProject","timestamp":"2016-02-10T17:23:04.491Z","version":"1.0.1","markersVersion":"1.0.5","globalSourceNames":["**/*.styl","**/*.stylus","**/*.less","**/*.sass","**/*.scss"],"globalIgnoredNames":["vendor/*","node_modules/*","spec/*","test/*"],"buffers":{"4":{"id":4,"path":"/home/andy/Documents/codesmith/lectures/unit-11-authentication/auth-demo/server.js","colorMarkers":[]}},"paths":[],"variables":{"deserializer":"VariablesCollection","content":[]}}},"fuzzy-finder":{"/home/andy/Documents/codesmith/lectures/unit-11-authentication/auth-demo/server.js":1455124959510},"tabs":[{}],"tree-view":{"directoryExpansionStates":{"/home/andy/Documents/codesmith/lectures/unit-11-authentication/auth-demo":{"isExpanded":true,"entries":{"node_modules":{"isExpanded":false,"entries":{}}}}},"selectedPath":"/home/andy/Documents/codesmith/lectures/unit-11-authentication/auth-demo/server.js","hasFocus":false,"attached":true,"scrollLeft":0,"scrollTop":0,"width":200}},"fullScreen":false}